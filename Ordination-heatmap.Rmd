---
title: "Ordination-heatmap"
author: "Yiwei"
date: "2/27/2020"
output: html_document
---

## Load Libraries
```{r}
library(readr)
library(phyloseq)
library(ggplot2)
library(dplyr)
library(stringr)
library(tidyr)
library(magrittr)
library(vegan)
```

## Define Paths
```{r}
poly.rds ="/sharedspace/polystyrene/demultiplexed3/dada2/ibiemProject1_subset.rds"
```

## Check Phyloseq RDS
Load your phyloseq RDS and `print` it just to be sure things look sane
```{r}
poly.ps = read_rds(poly.rds)
print(poly.ps)
```

```{r}
# save sample data as a data frame
df <- sample_data(poly.ps)
head(df)
```

Subset by LF
```{r}
ps_LF <- subset_samples(poly.ps, Location == "LF")
ps_ER <- subset_samples(poly.ps, Location == "ER")
ps_AS <- subset_samples(poly.ps, Location == "AS")
ps_RC <- subset_samples(poly.ps, Location == "RC")

```



```{r}
#ordination 
ps.ord <- ordinate(poly.ps, "NMDS", "bray")
p2=plot_ordination(poly.ps, ps.ord, type = "taxa", color= "Location")
print(p2)
```



```{r}
#ordination 
ps_LF.ord <- ordinate(ps_LF, "NMDS", "bray")
p1=plot_ordination(ps_LF, ps_LF.ord, type = "taxa", color = "Condition")
print(p1)
```



```{r}
ps_LF_Acidobacteria <- subset_taxa(ps_LF, Phylum == "Acidobacteria")
ps_LF_Acidobacteria_pruned<- prune_taxa(names(sort(taxa_sums(ps_LF_Acidobacteria),TRUE)[1:300]), ps_LF_Acidobacteria)
ps_LF_Acidobacteria_pruned

```

```{r}
plot_heatmap(ps_LF_Acidobacteria_pruned, "NMDS", "bray", taxa.label = "Family", max.label=300)
```

```{r}
pcoa_subset_biom(ps_LF, method = "PCoA", distance = "unifrac", samples,
  color_category = NULL, shape_category = NULL, weighted = FALSE,
  title = NULL, colors = NULL, shapes = NULL, seed = 100,
  xrange = NULL, yrange = NULL)
```

